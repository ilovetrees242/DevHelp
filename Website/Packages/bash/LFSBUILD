#!/bin/sh
LFSPKGNAME="bash"
LFSPKGVERSION="5.3"
LFSPKG="$LFSPKGNAME-$LFSPKGVERSION"
DEPENDS="ncurses readline glibc"
case $1 in
	chkdeps)
        NCURSES = $(readelf -d $(find /usr -name "libncursesw.so") | grep "soname" | awk '{print $5}')
		if [ -z "$NCURSES" ]; then
            echo "ncurses not found!"
		fi
		command ldconfig
		if [ $? -eq 127 ]; then
			echo "$(echo $DEPENDS | awk '{print $3}') not found!"
			exit 1
		fi	
	;;
	build)
		tar xvf $LFSPKG.tar.gz
		pushd $LFSPKG
			./configure --prefix=/usr --without-bash-malloc --with-installed-readline
			make
			make install
		popd
		rm -rf $LFSPKG
	;;
	uninstall)
		rm -f /usr/bin/{bash,bashbug}
		rm -rf /usr/{include,lib}/bash
		rm -f /usr/lib/pkgconfig/bash.pc
		rm -rf /usr/share/doc/bash
		rm -rf /usr/share/info/bash.info
		rm -f /usr/share/man/bash*.1
	;;
esac

